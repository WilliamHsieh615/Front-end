<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>餅乾庫存管理系統</title>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">

</head>

<body>

    <div id="app" class="container mt-5 mb-5">
        <h1 class="text-center mb-3">餅乾庫存管理系統</h1>
        <table class="table table-bordered table-striped table-hover">
            <thead>
                <tr class="text-center">
                    <th scope="col">品項</th>
                    <th scope="col">描述</th>
                    <th scope="col">價格</th>
                    <th scope="col">庫存</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" :key="item.id">
                    <template v-if="!isEdit">
                        <td>{{ item.name }}</td>
                        <td>{{ item.description }}</td>
                        <td class="text-center">{{ item.price }}</td>
                        <td class="text-center">{{ item.stock }}</td>
                    </template>
                    <template v-else>
                        <td><input type="text" class="form-control" v-model="item.name" /></td>
                        <td><input type="text" class="form-control" v-model="item.description" /></td>
                        <td class="text-center"><input type="number" class="form-control" v-model.number="item.price" /></td>
                        <td class="text-center w-25">
                            <button @click="decrease(item)" :disabled="item.stock < 1">-</button>
                            {{ item.stock }}
                            <button @click="increase(item)">+</button>
                        </td>
                    </template>
                </tr>
            </tbody>
        </table>
        <button class="form-control btn btn-outline-success" style="width: 100%;" @click="isEdit = true" v-if="!isEdit">編輯</button>
        <button class="form-control btn btn-outline-success" style="width: 100%;" @click="isEdit = false" v-if="isEdit">確定</button>
    </div>

    <script>

        const { createApp, ref, onMounted } = Vue;

        createApp({
            setup() {

                const items = ref([]);
                console.log(items);

                const isEdit = ref(false);

                onMounted(() => {
                    axios.get("./data.json")
                        .then(res => {
                            console.log(res.data);
                            items.value = res.data;
                        }).catch(err => {
                            console.log("no data");
                        });
                });

                const increase = (item) => {
                    item.stock++;
                };

                const decrease = (item) => {
                    if (item.stock > 0) item.stock--;
                };

                return { items, increase, decrease, isEdit };
            }
        }).mount('#app');

    </script>

</body>

</html>